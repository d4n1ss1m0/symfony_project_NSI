{% extends 'base.html.twig' %}

{% block title %}Hello UserCrudController!{% endblock %}
{% block javascripts %}
  {{parent()}}
  <script>
        
        function deleteUser(id){
            $.ajax({
                method: 'POST',
                url: "/admin_panel/delete_user/"+id
            }).done(getUsers());
        }
        function getEditForm(id) {
          
            console.log("Добро пожаловать в Веб-консоль");
            $.ajax({
                method: 'POST',
                url: "/admin_panel/edit_user/"+id
            }).done(function (data) {
                $('.js-addUser').html(data);
            });            
        }
    </script>
{% endblock %}
{% block body %}
{{ parent() }}
<!--
<style>
    .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
    .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
</style>
-->
<div class="d-flex flex-row-reverse">
<button type="button" class="btn btn-outline-primary " data-bs-toggle="modal" data-bs-target="#staticBackdrop" onclick="getAddForm('add_user')" >Add user</button>

</div>
<table class="table table-striped mt-3 shadow p-3 mb-5 bg-body rounded">
  <tr>
    <th>id</th>
    <th>Email</th>
    <th>Password</th>
    <th>Roles</th>
    <th></th>
    <th></th>
  </tr>
{% if users is defined %}
  {% for user in users %}
    <tr>
      <td>{{ user.id }}</td>
      <td>{{ user.email }}</td>
      <td>{{ user.password }}</td>
      <td>{{ user.Roles | json_encode() }}</td>
      <td><button type="button" class="btn btn-primary " data-bs-toggle="modal" data-bs-target="#staticBackdrop" onclick="getEditForm({{user.id}})">Primary</button></td>
      <td><button type="button" class="btn btn-danger" onclick="deleteUser({{user.id}})">Delete</button></td>
    </tr>
  {% endfor %}
{% endif %}
</table>
{% endblock %}
